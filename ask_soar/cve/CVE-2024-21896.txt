

A vulnerability (CVE-2024-21896) has been discovered in the experimental permission model of Node.js versions 20 and 21. The vulnerability allows for path traversal attacks due to a monkey-patching of Buffer internals, specifically Buffer.prototype.utf8Write. This can be exploited by modifying the result of path.resolve(), leading to a vulnerability that affects all users of the experimental permission model. The severity of the vulnerability is high, with a base score of 7.9 and a base severity of HIGH. The attack vector is local, and user interaction is required. The vulnerability has been identified by support@hackerone.com, and a report is available on HackerOne.

The vulnerability arises from the permission model's use of path.resolve() to resolve paths given by the user. The implementation uses Buffer.from() to obtain a Buffer from the result of path.resolve(), which can be manipulated by monkey-patching Buffer internals. This allows an attacker to modify the result of path.resolve(), leading to a path traversal vulnerability.

The vulnerability has been assigned a CVSS score of 7.9, with an exploitability score of 1.5 and an impact score of 5.8. The attack complexity is low, and the privileges required are low. The scope of the vulnerability is changed, and the confidentiality, integrity, and availability impacts are high, medium, and none, respectively.

It is recommended that users of the experimental permission model in Node.js versions 20 and 21 take immediate action to patch or mitigate this vulnerability. The report on HackerOne provides further details and guidance on how to address the vulnerability.